@model Trackii.Models.Admin.Product.ProductListVm

<h2>Products</h2>

<form method="get" action="/Admin/Product">

    <!-- Área -->
    <select name="areaId">
        <option value="">-- Área --</option>
        @foreach (var a in Model.Areas)
        {
            if (Model.AreaId == a.Id)
            {
                <option value="@a.Id" selected>@a.Name</option>
            }
            else
            {
                <option value="@a.Id">@a.Name</option>
            }
        }
    </select>

    <!-- Family -->
    <select name="familyId">
        <option value="">-- Family --</option>
        @foreach (var f in Model.Families)
        {
            if (Model.FamilyId == f.Id)
            {
                <option value="@f.Id" selected>@f.Name</option>
            }
            else
            {
                <option value="@f.Id">@f.Name</option>
            }
        }
    </select>

    <!-- Subfamily -->
    <select name="subfamilyId">
        <option value="">-- Subfamily --</option>
        @foreach (var s in Model.Subfamilies)
        {
            if (Model.SubfamilyId == s.Id)
            {
                <option value="@s.Id" selected>@s.Name</option>
            }
            else
            {
                <option value="@s.Id">@s.Name</option>
            }
        }
    </select>

    <input name="search"
           value="@Model.Search"
           placeholder="Part number..." />

    <label>
        <input type="checkbox"
               name="showInactive"
               value="true"
               @(Model.ShowInactive ? "checked" : "") />
        Ver inactivos
    </label>

    <button type="submit">Filtrar</button>
    <a href="/Admin/Product/Create">Nuevo</a>
</form>

@if (TempData["Error"] != null)
{
    <div style="color:red; font-weight:bold;">
        @TempData["Error"]
    </div>
}

<table border="1" cellpadding="5">
    <tr>
        <th>Área</th>
        <th>Family</th>
        <th>Subfamily</th>
        <th>Part Number</th>
        <th>Activo</th>
        <th></th>
    </tr>

    @foreach (var p in Model.Items)
    {
        <tr>
            <td>@p.Area</td>
            <td>@p.Family</td>
            <td>@p.Subfamily</td>
            <td>@p.PartNumber</td>
            <td>@p.Active</td>
            <td>
                <a href="/Admin/Product/Edit/@p.Id">Editar</a>

                <form action="/Admin/Product/Toggle"
                      method="post"
                      style="display:inline">
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="id" value="@p.Id" />
                    <input type="hidden" name="active"
                           value="@(p.Active ? 0 : 1)" />
                    <button type="submit">
                        @(p.Active ? "Desactivar" : "Activar")
                    </button>
                </form>
            </td>
        </tr>
    }
</table>

@if (Model.TotalPages > 1)
{
    <div>
        @for (int i = 1; i <= Model.TotalPages; i++)
        {
            if (i == Model.Page)
            {
                <strong>@i</strong>
            }
            else
            {
                <a href="/Admin/Product?page=@i
                             &areaId=@Model.AreaId
                             &familyId=@Model.FamilyId
                             &subfamilyId=@Model.SubfamilyId
                             &search=@Model.Search
                             &showInactive=@(Model.ShowInactive ? "true" : "")">
                    @i
                </a>
            }
        }
    </div>
}
